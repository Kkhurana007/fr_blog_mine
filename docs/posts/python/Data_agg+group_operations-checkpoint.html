<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kunal Khurana">
<meta name="dcterms.date" content="2024-03-01">

<title>Homepage - Group operations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YSR47ZM5Y0"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-YSR47ZM5Y0', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Homepage - Group operations">
<meta name="twitter:description" content="Data aggregation, grouping, and pivoting">
<meta name="twitter:image" content="https://ilovesoils.com/posts/python/group_operations.png">
<meta name="twitter:creator" content="@kunalkhurana007">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="256">
<meta name="twitter:image-width" content="661">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Homepage</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Kunal Khurana</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-posts" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Posts</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-posts">    
        <li>
    <a class="dropdown-item" href="../../posts/index.html" rel="" target="">
 <span class="dropdown-text">All posts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/en.html" rel="" target="">
 <span class="dropdown-text">English</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/fr.html" rel="" target="">
 <span class="dropdown-text">Français</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Kkhurana007/fr_blog_mine" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/kunalkhurana007" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Group operations</h1>
            <p class="subtitle lead">Data aggregation, grouping, and pivoting</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Pandas</div>
                <div class="quarto-category">pivot_tabes</div>
                <div class="quarto-category">groupby</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kunal Khurana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 1, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-to-think-about-group-operations" id="toc-how-to-think-about-group-operations" class="nav-link active" data-scroll-target="#how-to-think-about-group-operations">How to think about group operations</a></li>
  <li><a href="#data-aggregation" id="toc-data-aggregation" class="nav-link" data-scroll-target="#data-aggregation">Data Aggregation</a></li>
  <li><a href="#apply-general-split-apply-combine" id="toc-apply-general-split-apply-combine" class="nav-link" data-scroll-target="#apply-general-split-apply-combine">Apply: General split-apply-combine</a></li>
  <li><a href="#group-transformations-adn-unwrapped-groupbys" id="toc-group-transformations-adn-unwrapped-groupbys" class="nav-link" data-scroll-target="#group-transformations-adn-unwrapped-groupbys">Group Transformations adn ‘Unwrapped’ GroupBys</a></li>
  <li><a href="#pivot-tables-adn-cross-tabulation" id="toc-pivot-tables-adn-cross-tabulation" class="nav-link" data-scroll-target="#pivot-tables-adn-cross-tabulation">Pivot tables adn Cross-tabulation</a>
  <ul class="collapse">
  <li><a href="#iterating-over-groups" id="toc-iterating-over-groups" class="nav-link" data-scroll-target="#iterating-over-groups">Iterating over groups</a></li>
  </ul></li>
  <li><a href="#selecting-a-column-or-subset-of-columns" id="toc-selecting-a-column-or-subset-of-columns" class="nav-link" data-scroll-target="#selecting-a-column-or-subset-of-columns">Selecting a Column or Subset of Columns</a>
  <ul class="collapse">
  <li><a href="#grouping-with-dictionaries-and-series" id="toc-grouping-with-dictionaries-and-series" class="nav-link" data-scroll-target="#grouping-with-dictionaries-and-series">Grouping with Dictionaries and Series</a></li>
  <li><a href="#grouping-with-functions" id="toc-grouping-with-functions" class="nav-link" data-scroll-target="#grouping-with-functions">Grouping with Functions</a></li>
  <li><a href="#grouping-with-index-levels" id="toc-grouping-with-index-levels" class="nav-link" data-scroll-target="#grouping-with-index-levels">Grouping with Index levels</a></li>
  </ul></li>
  <li><a href="#data-aggregation-1" id="toc-data-aggregation-1" class="nav-link" data-scroll-target="#data-aggregation-1">Data Aggregation</a>
  <ul class="collapse">
  <li><a href="#column-wise-multiple-function-application" id="toc-column-wise-multiple-function-application" class="nav-link" data-scroll-target="#column-wise-multiple-function-application">Column-Wise multiple function application</a></li>
  </ul></li>
  <li><a href="#apply-general-split-apply-combine-1" id="toc-apply-general-split-apply-combine-1" class="nav-link" data-scroll-target="#apply-general-split-apply-combine-1">Apply: General split-apply-combine</a>
  <ul class="collapse">
  <li><a href="#suppressing-the-group-keys" id="toc-suppressing-the-group-keys" class="nav-link" data-scroll-target="#suppressing-the-group-keys">Suppressing the Group Keys</a></li>
  <li><a href="#quantile-and-bucket-analysis" id="toc-quantile-and-bucket-analysis" class="nav-link" data-scroll-target="#quantile-and-bucket-analysis">Quantile and Bucket analysis</a></li>
  <li><a href="#ex-filling-missing-values-with-group-spscific-values" id="toc-ex-filling-missing-values-with-group-spscific-values" class="nav-link" data-scroll-target="#ex-filling-missing-values-with-group-spscific-values">Ex: Filling missing values with group-spscific values</a></li>
  <li><a href="#ex-random-sampling-and-permutation" id="toc-ex-random-sampling-and-permutation" class="nav-link" data-scroll-target="#ex-random-sampling-and-permutation">Ex: Random Sampling and Permutation</a></li>
  <li><a href="#ex-group-weighted-average-and-correlation" id="toc-ex-group-weighted-average-and-correlation" class="nav-link" data-scroll-target="#ex-group-weighted-average-and-correlation">Ex: Group weighted Average and Correlation</a></li>
  <li><a href="#ex-group-wise-linear-regression" id="toc-ex-group-wise-linear-regression" class="nav-link" data-scroll-target="#ex-group-wise-linear-regression">Ex: Group-Wise linear Regression</a></li>
  <li><a href="#group-transforms-and-unwrapped-groupbys" id="toc-group-transforms-and-unwrapped-groupbys" class="nav-link" data-scroll-target="#group-transforms-and-unwrapped-groupbys">Group transforms and ‘Unwrapped’ GroupBys</a></li>
  <li><a href="#pivot-tables" id="toc-pivot-tables" class="nav-link" data-scroll-target="#pivot-tables">Pivot tables</a></li>
  <li><a href="#cross--tabulation" id="toc-cross--tabulation" class="nav-link" data-scroll-target="#cross--tabulation">Cross- tabulation</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Data_agg+group_operations-checkpoint.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="how-to-think-about-group-operations" class="level2">
<h2 class="anchored" data-anchor-id="how-to-think-about-group-operations">How to think about group operations</h2>
<ul>
<li>Iterating over groups</li>
<li>Selecting a column or subset of columns</li>
<li>Grouping with dictionaries and series</li>
<li>Grouping with functions</li>
<li>Grouping by Index levels</li>
</ul>
</section>
<section id="data-aggregation" class="level2">
<h2 class="anchored" data-anchor-id="data-aggregation">Data Aggregation</h2>
<ul>
<li>Column-wise and Multiple Function Application</li>
<li>Returning aggregated Data without Row Indexes</li>
</ul>
</section>
<section id="apply-general-split-apply-combine" class="level2">
<h2 class="anchored" data-anchor-id="apply-general-split-apply-combine">Apply: General split-apply-combine</h2>
<ul>
<li>Suppressing the Group keys</li>
<li>Quantile and Bucked analysis</li>
<li>Filling missing and group specific values</li>
<li>Random sampling and permutation</li>
<li>group Weighted Average and Correlation</li>
<li>group wise linear regression</li>
</ul>
</section>
<section id="group-transformations-adn-unwrapped-groupbys" class="level2">
<h2 class="anchored" data-anchor-id="group-transformations-adn-unwrapped-groupbys">Group Transformations adn ‘Unwrapped’ GroupBys</h2>
</section>
<section id="pivot-tables-adn-cross-tabulation" class="level2">
<h2 class="anchored" data-anchor-id="pivot-tables-adn-cross-tabulation">Pivot tables adn Cross-tabulation</h2>
<ul>
<li>cross-tabulations: crosstab</li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">"key1"</span>: [<span class="st">'a'</span>, <span class="st">'a'</span>, <span class="va">None</span>, <span class="st">'b'</span>, <span class="st">'c'</span>],</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'key2'</span> : pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="va">None</span>, <span class="dv">5</span>], </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                     dtype<span class="op">=</span><span class="st">'Int64'</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'data1'</span> : np.random.standard_normal(<span class="dv">5</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'data2'</span> : np.random.standard_normal(<span class="dv">5</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                     </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                     })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>1</td>
<td>-0.949232</td>
<td>-0.859027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>a</td>
<td>2</td>
<td>0.902370</td>
<td>0.987569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>None</td>
<td>3</td>
<td>0.805328</td>
<td>-0.892250</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>b</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>c</td>
<td>5</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># mean of data1 using labels from key1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> df[<span class="st">"data1"</span>].groupby(df[<span class="st">'key1'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x0000018F93327910&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>means <span class="op">=</span> df[<span class="st">'data1'</span>].groupby([df[<span class="st">'key1'</span>], df[<span class="st">"key2"</span>]]).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>key1  key2
a     1      -0.949232
      2       0.902370
c     5      -1.341779
Name: data1, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>means.unstack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">5</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>-0.949232</td>
<td>0.90237</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">c</td>
<td>NaN</td>
<td>NaN</td>
<td>-1.341779</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using Series as groupkeys</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> np.array([<span class="st">'PB'</span>, <span class="st">'DL'</span>, <span class="st">'UK'</span>, <span class="st">'HP'</span>, <span class="st">'UP'</span>,])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> [<span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2005</span>, <span class="dv">2001</span>, <span class="dv">2009</span>,]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'data1'</span>].groupby([states, years]).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>DL  2002    0.902370
HP  2001    0.269996
PB  2001   -0.949232
UK  2005    0.805328
UP  2009   -1.341779
Name: data1, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>grouped.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>key1
a   -0.023431
b    0.269996
c   -1.341779
Name: data1, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>means2 <span class="op">=</span> df[<span class="st">'data1'</span>].groupby([df[<span class="st">'key1'</span>], df[<span class="st">'key2'</span>]]).mean()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>means2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>key1  key2
a     1      -0.949232
      2       0.902370
c     5      -1.341779
Name: data1, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>means2.unstack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">5</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>-0.949232</td>
<td>0.90237</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">c</td>
<td>NaN</td>
<td>NaN</td>
<td>-1.341779</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>means2.unstack(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.949232</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.902370</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>-1.341779</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'key1'</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>1.5</td>
<td>-0.023431</td>
<td>0.064271</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>1</td>
<td>-0.949232</td>
<td>-0.859027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>a</td>
<td>2</td>
<td>0.902370</td>
<td>0.987569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>None</td>
<td>3</td>
<td>0.805328</td>
<td>-0.892250</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>b</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>c</td>
<td>5</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'key1'</span>, <span class="st">'key2'</span>]).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">a</td>
<td data-quarto-table-cell-role="th">1</td>
<td>-0.949232</td>
<td>-0.859027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.902370</td>
<td>0.987569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td data-quarto-table-cell-role="th">5</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'key1'</span>, <span class="st">'key2'</span>]).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>key1  key2
a     1       1
      2       1
c     5       1
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'key1'</span>, dropna<span class="op">=</span> <span class="va">False</span>).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>key1
a      2
b      1
c      1
NaN    1
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'key1'</span>, <span class="st">'key2'</span>], dropna<span class="op">=</span><span class="va">False</span>).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>key1  key2
a     1       1
      2       1
b     &lt;NA&gt;    1
c     5       1
NaN   3       1
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'key1'</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="iterating-over-groups" class="level3">
<h3 class="anchored" data-anchor-id="iterating-over-groups">Iterating over groups</h3>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, group <span class="kw">in</span> df.groupby(<span class="st">'key1'</span>):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(name)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a
  key1  key2     data1     data2
0    a     1 -0.949232 -0.859027
1    a     2  0.902370  0.987569
b
  key1  key2     data1     data2
3    b  &lt;NA&gt;  0.269996  0.291597
c
  key1  key2     data1     data2
4    c     5 -1.341779 -0.229023</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in case of multiple key elements</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k1, k2), group <span class="kw">in</span> df.groupby([<span class="st">'key1'</span>,<span class="st">'key2'</span>]):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>((k1, k2))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('a', 1)
  key1  key2     data1     data2
0    a     1 -0.949232 -0.859027
('a', 2)
  key1  key2    data1     data2
1    a     2  0.90237  0.987569
('c', 5)
  key1  key2     data1     data2
4    c     5 -1.341779 -0.229023</code></pre>
</div>
</div>
<section id="dictionary-data-in-the-form-of-pieces" class="level4">
<h4 class="anchored" data-anchor-id="dictionary-data-in-the-form-of-pieces">dictionary data in the form of pieces</h4>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pieces <span class="op">=</span> {name : group <span class="cf">for</span> name, group <span class="kw">in</span> df.groupby(<span class="st">'key1'</span>)}</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>pieces[<span class="st">'b'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>b</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pieces[<span class="st">'c'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>c</td>
<td>5</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> df.groupby({<span class="st">'key1'</span>: <span class="st">'key'</span>,<span class="st">'key2'</span>: <span class="st">'key'</span>,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'data1'</span>: <span class="st">'data'</span>, <span class="st">'data2'</span>: <span class="st">'data'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000018F9795F9A0&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group_key, group_values <span class="kw">in</span> grouped:</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(group_key)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(group_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="selecting-a-column-or-subset-of-columns" class="level2">
<h2 class="anchored" data-anchor-id="selecting-a-column-or-subset-of-columns">Selecting a Column or Subset of Columns</h2>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'key1'</span>)[<span class="st">'data1'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x0000018F978AF040&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'key1'</span>)[[<span class="st">'data2'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000018F97822580&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this can also be called by-</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'data1'</span>].groupby(df[<span class="st">'key1'</span>])</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'data2'</span>].groupby(df[<span class="st">'key1'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x0000018F978EE970&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'key1'</span>, <span class="st">'key2'</span>])[[<span class="st">'data2'</span>]].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">a</td>
<td data-quarto-table-cell-role="th">1</td>
<td>-0.859027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.987569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td data-quarto-table-cell-role="th">5</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>s_grouped <span class="op">=</span> df.groupby([<span class="st">'key1'</span>, <span class="st">'key2'</span>])[<span class="st">'data2'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>s_grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x0000018F97770520&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>s_grouped.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>key1  key2
a     1      -0.859027
      2       0.987569
c     5      -0.229023
Name: data2, dtype: float64</code></pre>
</div>
</div>
<section id="grouping-with-dictionaries-and-series" class="level3">
<h3 class="anchored" data-anchor-id="grouping-with-dictionaries-and-series">Grouping with Dictionaries and Series</h3>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>people <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">5</span>,<span class="dv">5</span>)),</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>,<span class="st">'e'</span>],</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                     index <span class="op">=</span> [<span class="st">'Kunal'</span>, <span class="st">'Rahul'</span>, <span class="st">'Sachin'</span>, <span class="st">'Sorav'</span>, <span class="st">'Andrew'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add few NA values</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>people.iloc[<span class="dv">2</span>:<span class="dv">3</span>, [<span class="dv">1</span>, <span class="dv">2</span>]] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
<th data-quarto-table-cell-role="th">d</th>
<th data-quarto-table-cell-role="th">e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Kunal</td>
<td>0.168348</td>
<td>-1.118059</td>
<td>-0.800172</td>
<td>-0.866632</td>
<td>-0.197982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Rahul</td>
<td>0.200227</td>
<td>0.640015</td>
<td>1.108393</td>
<td>-0.085850</td>
<td>-0.888133</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sachin</td>
<td>0.847146</td>
<td>NaN</td>
<td>NaN</td>
<td>0.463212</td>
<td>-0.077719</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Sorav</td>
<td>1.440603</td>
<td>0.431537</td>
<td>-0.670088</td>
<td>-0.121215</td>
<td>-1.211302</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Andrew</td>
<td>-0.637420</td>
<td>0.237133</td>
<td>-0.426589</td>
<td>-0.631543</td>
<td>0.098273</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'a'</span>: <span class="st">'red'</span>, <span class="st">'b'</span>: <span class="st">'red'</span>, <span class="st">'c'</span>: <span class="st">'blue'</span>,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'d'</span>: <span class="st">'blue'</span>, <span class="st">'e'</span>: <span class="st">'red'</span>, <span class="st">'f'</span>: <span class="st">'orange'</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>by_column <span class="op">=</span> people.groupby(mapping, axis<span class="op">=</span> <span class="st">'columns'</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>by_column.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">blue</th>
<th data-quarto-table-cell-role="th">red</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Kunal</td>
<td>-1.666804</td>
<td>-1.147693</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Rahul</td>
<td>1.022543</td>
<td>-0.047891</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sachin</td>
<td>0.463212</td>
<td>0.769427</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Sorav</td>
<td>-0.791303</td>
<td>0.660838</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Andrew</td>
<td>-1.058132</td>
<td>-0.302014</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same functionality holds for Series</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>map_series <span class="op">=</span> pd.Series(mapping)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>map_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>a       red
b       red
c      blue
d      blue
e       red
f    orange
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>people.groupby(map_series, axis<span class="op">=</span> <span class="st">'columns'</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">blue</th>
<th data-quarto-table-cell-role="th">red</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Kunal</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Rahul</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sachin</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Sorav</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Andrew</td>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="grouping-with-functions" class="level3">
<h3 class="anchored" data-anchor-id="grouping-with-functions">Grouping with Functions</h3>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>people.groupby(<span class="bu">len</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
<th data-quarto-table-cell-role="th">d</th>
<th data-quarto-table-cell-role="th">e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>1.809178</td>
<td>-0.046507</td>
<td>-0.361866</td>
<td>-1.073697</td>
<td>-2.297416</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>0.209726</td>
<td>0.237133</td>
<td>-0.426589</td>
<td>-0.168331</td>
<td>0.020554</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mixing functions with arrays, dicitonaries, or Series</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>key_list <span class="op">=</span> [<span class="st">'one'</span>, <span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'one'</span>, <span class="st">'two'</span>]</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>people.groupby([<span class="bu">len</span>, key_list]).<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
<th data-quarto-table-cell-role="th">d</th>
<th data-quarto-table-cell-role="th">e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td data-quarto-table-cell-role="th">one</td>
<td>0.168348</td>
<td>-1.118059</td>
<td>-0.800172</td>
<td>-0.866632</td>
<td>-1.211302</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td data-quarto-table-cell-role="th">two</td>
<td>-0.637420</td>
<td>0.237133</td>
<td>-0.426589</td>
<td>-0.631543</td>
<td>-0.077719</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="grouping-with-index-levels" class="level3">
<h3 class="anchored" data-anchor-id="grouping-with-index-levels">Grouping with Index levels</h3>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>levels <span class="op">=</span> pd.MultiIndex.from_arrays([[<span class="st">'IN'</span>, <span class="st">'US'</span>, <span class="st">'CAN'</span>],</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                   [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]],</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                                   names<span class="op">=</span>[<span class="st">'fdk'</span>, <span class="st">'goleala'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>hier_df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">4</span>,<span class="dv">3</span>)),</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                      columns <span class="op">=</span> levels)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>hier_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">fdk</th>
<th data-quarto-table-cell-role="th">IN</th>
<th data-quarto-table-cell-role="th">US</th>
<th data-quarto-table-cell-role="th">CAN</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">goleala</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.973483</td>
<td>0.175499</td>
<td>-1.375942</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.417278</td>
<td>-0.593448</td>
<td>-0.097291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.864057</td>
<td>-1.157927</td>
<td>0.219800</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.062763</td>
<td>0.796581</td>
<td>-0.905844</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to groupby level, pass level keyword</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>hier_df.groupby(level <span class="op">=</span> <span class="st">'fdk'</span>, axis <span class="op">=</span> <span class="st">'columns'</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">fdk</th>
<th data-quarto-table-cell-role="th">CAN</th>
<th data-quarto-table-cell-role="th">IN</th>
<th data-quarto-table-cell-role="th">US</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="data-aggregation-1" class="level2">
<h2 class="anchored" data-anchor-id="data-aggregation-1">Data Aggregation</h2>
<ul>
<li>transformation that produces scalar values</li>
<li><a href="https://learning.oreilly.com/library/view/python-for-data/9781098104023/ch10.html#table_opt_groupby_methods">optimised methods</a></li>
</ul>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>1</td>
<td>-0.949232</td>
<td>-0.859027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>a</td>
<td>2</td>
<td>0.902370</td>
<td>0.987569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>None</td>
<td>3</td>
<td>0.805328</td>
<td>-0.892250</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>b</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>c</td>
<td>5</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> df.groupby(<span class="st">'key1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'data1'</span>].nsmallest(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>key1   
a     0   -0.949232
      1    0.902370
b     3    0.269996
c     4   -1.341779
Name: data1, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregation function</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> peak_to_peak(arr):</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> arr.<span class="bu">max</span>() <span class="op">-</span> arr.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>grouped.agg(peak_to_peak)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>1</td>
<td>1.851602</td>
<td>1.846596</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b</td>
<td>&lt;NA&gt;</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td>0</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>grouped.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">key2</th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">data1</th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>2.0</td>
<td>1.5</td>
<td>0.707107</td>
<td>1.0</td>
<td>1.25</td>
<td>1.5</td>
<td>1.75</td>
<td>2.0</td>
<td>2.0</td>
<td>-0.023431</td>
<td>...</td>
<td>0.439470</td>
<td>0.902370</td>
<td>2.0</td>
<td>0.064271</td>
<td>1.305741</td>
<td>-0.859027</td>
<td>-0.397378</td>
<td>0.064271</td>
<td>0.525920</td>
<td>0.987569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b</td>
<td>0.0</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>1.0</td>
<td>0.269996</td>
<td>...</td>
<td>0.269996</td>
<td>0.269996</td>
<td>1.0</td>
<td>0.291597</td>
<td>NaN</td>
<td>0.291597</td>
<td>0.291597</td>
<td>0.291597</td>
<td>0.291597</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td>1.0</td>
<td>5.0</td>
<td>&lt;NA&gt;</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>1.0</td>
<td>-1.341779</td>
<td>...</td>
<td>-1.341779</td>
<td>-1.341779</td>
<td>1.0</td>
<td>-0.229023</td>
<td>NaN</td>
<td>-0.229023</td>
<td>-0.229023</td>
<td>-0.229023</td>
<td>-0.229023</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

<p>3 rows × 24 columns</p>
</div>
</div>
</div>
<section id="column-wise-multiple-function-application" class="level3">
<h3 class="anchored" data-anchor-id="column-wise-multiple-function-application">Column-Wise multiple function application</h3>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> pd.read_csv(<span class="vs">r"E:\pythonfordatanalysis\semainedu26fevrier\iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>iris.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
<th data-quarto-table-cell-role="th">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>4.6</td>
<td>3.1</td>
<td>1.5</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>5.0</td>
<td>3.6</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>iris.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>Index(['Id', 'Sepal Length (cm)', 'Sepal Width (cm)', 'Petal Length (cm)',
       'Petal Width (cm)', 'Species'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>grouped2 <span class="op">=</span> iris.groupby([<span class="st">'Sepal Length (cm)'</span>, <span class="st">'Sepal Width (cm)'</span>, <span class="st">'Petal Length (cm)'</span>,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Petal Width (cm)'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> iris.isna()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>missing_values.<span class="bu">sum</span> <span class="op">=</span> iris.isna().<span class="bu">sum</span>()</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>missing_values_percent <span class="op">=</span> (iris.isna().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(iris)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>iris.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 150 entries, 0 to 149
Data columns (total 6 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   Id                 150 non-null    int64  
 1   Sepal Length (cm)  150 non-null    float64
 2   Sepal Width (cm)   150 non-null    float64
 3   Petal Length (cm)  150 non-null    float64
 4   Petal Width (cm)   150 non-null    float64
 5   Species            150 non-null    object 
dtypes: float64(4), int64(1), object(1)
memory usage: 7.2+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>grouped.agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, peak_to_peak])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">key2</th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">data1</th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">peak_to_peak</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">peak_to_peak</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">peak_to_peak</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>1.5</td>
<td>0.707107</td>
<td>1</td>
<td>-0.023431</td>
<td>1.30928</td>
<td>1.851602</td>
<td>0.064271</td>
<td>1.305741</td>
<td>1.846596</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>NaN</td>
<td>0.000000</td>
<td>0.291597</td>
<td>NaN</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td>5.0</td>
<td>&lt;NA&gt;</td>
<td>0</td>
<td>-1.341779</td>
<td>NaN</td>
<td>0.000000</td>
<td>-0.229023</td>
<td>NaN</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping column as it gave traceback before</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>iris2 <span class="op">=</span> iris.drop(<span class="st">'Species'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>iris2.agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, peak_to_peak])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">mean</td>
<td>75.500000</td>
<td>5.843333</td>
<td>3.054000</td>
<td>3.758667</td>
<td>1.198667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>43.445368</td>
<td>0.828066</td>
<td>0.433594</td>
<td>1.764420</td>
<td>0.763161</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">peak_to_peak</td>
<td>149.000000</td>
<td>3.600000</td>
<td>2.400000</td>
<td>5.900000</td>
<td>2.400000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="apply-general-split-apply-combine-1" class="level2">
<h2 class="anchored" data-anchor-id="apply-general-split-apply-combine-1">Apply: General split-apply-combine</h2>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> top(iris2, n<span class="op">=</span><span class="dv">5</span>, column <span class="op">=</span> <span class="st">'Sepal Length (cm)'</span>):</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> iris2.sort_values(column, ascending<span class="op">=</span> <span class="va">False</span>)[:n]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>top(iris2, n<span class="op">=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">131</td>
<td>132</td>
<td>7.9</td>
<td>3.8</td>
<td>6.4</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>136</td>
<td>7.7</td>
<td>3.0</td>
<td>6.1</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">122</td>
<td>123</td>
<td>7.7</td>
<td>2.8</td>
<td>6.7</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">117</td>
<td>118</td>
<td>7.7</td>
<td>3.8</td>
<td>6.7</td>
<td>2.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>119</td>
<td>7.7</td>
<td>2.6</td>
<td>6.9</td>
<td>2.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105</td>
<td>106</td>
<td>7.6</td>
<td>3.0</td>
<td>6.6</td>
<td>2.1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>iris2.groupby(<span class="st">'Sepal Length (cm)'</span>).<span class="bu">apply</span>(top)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.3</td>
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>4.3</td>
<td>3.0</td>
<td>1.1</td>
<td>0.1</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">4.4</td>
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>4.4</td>
<td>2.9</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>39</td>
<td>4.4</td>
<td>3.0</td>
<td>1.3</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42</td>
<td>43</td>
<td>4.4</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.5</td>
<td data-quarto-table-cell-role="th">41</td>
<td>42</td>
<td>4.5</td>
<td>2.3</td>
<td>1.3</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">7.7</td>
<td data-quarto-table-cell-role="th">117</td>
<td>118</td>
<td>7.7</td>
<td>3.8</td>
<td>6.7</td>
<td>2.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">118</td>
<td>119</td>
<td>7.7</td>
<td>2.6</td>
<td>6.9</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">122</td>
<td>123</td>
<td>7.7</td>
<td>2.8</td>
<td>6.7</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>136</td>
<td>7.7</td>
<td>3.0</td>
<td>6.1</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7.9</td>
<td data-quarto-table-cell-role="th">131</td>
<td>132</td>
<td>7.9</td>
<td>3.8</td>
<td>6.4</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>120 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recall by groupby object</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> iris2.groupby(<span class="st">"Sepal Length (cm)"</span>).describe()</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">Id</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Petal Length (cm)</th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">Petal Width (cm)</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.3</td>
<td>1.0</td>
<td>14.000000</td>
<td>NaN</td>
<td>14.0</td>
<td>14.00</td>
<td>14.0</td>
<td>14.00</td>
<td>14.0</td>
<td>1.0</td>
<td>3.000000</td>
<td>...</td>
<td>1.100</td>
<td>1.1</td>
<td>1.0</td>
<td>0.100000</td>
<td>NaN</td>
<td>0.1</td>
<td>0.100</td>
<td>0.10</td>
<td>0.100</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.4</td>
<td>3.0</td>
<td>30.333333</td>
<td>18.583146</td>
<td>9.0</td>
<td>24.00</td>
<td>39.0</td>
<td>41.00</td>
<td>43.0</td>
<td>3.0</td>
<td>3.033333</td>
<td>...</td>
<td>1.350</td>
<td>1.4</td>
<td>3.0</td>
<td>0.200000</td>
<td>3.399350e-17</td>
<td>0.2</td>
<td>0.200</td>
<td>0.20</td>
<td>0.200</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.5</td>
<td>1.0</td>
<td>42.000000</td>
<td>NaN</td>
<td>42.0</td>
<td>42.00</td>
<td>42.0</td>
<td>42.00</td>
<td>42.0</td>
<td>1.0</td>
<td>2.300000</td>
<td>...</td>
<td>1.300</td>
<td>1.3</td>
<td>1.0</td>
<td>0.300000</td>
<td>NaN</td>
<td>0.3</td>
<td>0.300</td>
<td>0.30</td>
<td>0.300</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.6</td>
<td>4.0</td>
<td>20.500000</td>
<td>20.141168</td>
<td>4.0</td>
<td>6.25</td>
<td>15.0</td>
<td>29.25</td>
<td>48.0</td>
<td>4.0</td>
<td>3.325000</td>
<td>...</td>
<td>1.425</td>
<td>1.5</td>
<td>4.0</td>
<td>0.225000</td>
<td>5.000000e-02</td>
<td>0.2</td>
<td>0.200</td>
<td>0.20</td>
<td>0.225</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.7</td>
<td>2.0</td>
<td>16.500000</td>
<td>19.091883</td>
<td>3.0</td>
<td>9.75</td>
<td>16.5</td>
<td>23.25</td>
<td>30.0</td>
<td>2.0</td>
<td>3.200000</td>
<td>...</td>
<td>1.525</td>
<td>1.6</td>
<td>2.0</td>
<td>0.200000</td>
<td>0.000000e+00</td>
<td>0.2</td>
<td>0.200</td>
<td>0.20</td>
<td>0.200</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.8</td>
<td>5.0</td>
<td>25.400000</td>
<td>14.046352</td>
<td>12.0</td>
<td>13.00</td>
<td>25.0</td>
<td>31.00</td>
<td>46.0</td>
<td>5.0</td>
<td>3.180000</td>
<td>...</td>
<td>1.600</td>
<td>1.9</td>
<td>5.0</td>
<td>0.200000</td>
<td>7.071068e-02</td>
<td>0.1</td>
<td>0.200</td>
<td>0.20</td>
<td>0.200</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.9</td>
<td>6.0</td>
<td>41.666667</td>
<td>37.866432</td>
<td>2.0</td>
<td>16.25</td>
<td>36.5</td>
<td>53.00</td>
<td>107.0</td>
<td>6.0</td>
<td>2.866667</td>
<td>...</td>
<td>2.850</td>
<td>4.5</td>
<td>6.0</td>
<td>0.533333</td>
<td>6.713171e-01</td>
<td>0.1</td>
<td>0.100</td>
<td>0.15</td>
<td>0.800</td>
<td>1.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.0</td>
<td>10.0</td>
<td>39.200000</td>
<td>26.029044</td>
<td>5.0</td>
<td>26.25</td>
<td>38.5</td>
<td>48.50</td>
<td>94.0</td>
<td>10.0</td>
<td>3.120000</td>
<td>...</td>
<td>1.600</td>
<td>3.5</td>
<td>10.0</td>
<td>0.430000</td>
<td>3.267687e-01</td>
<td>0.2</td>
<td>0.200</td>
<td>0.25</td>
<td>0.550</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.1</td>
<td>9.0</td>
<td>35.111111</td>
<td>28.117808</td>
<td>1.0</td>
<td>20.00</td>
<td>24.0</td>
<td>45.00</td>
<td>99.0</td>
<td>9.0</td>
<td>3.477778</td>
<td>...</td>
<td>1.700</td>
<td>3.0</td>
<td>9.0</td>
<td>0.400000</td>
<td>2.828427e-01</td>
<td>0.2</td>
<td>0.200</td>
<td>0.30</td>
<td>0.400</td>
<td>1.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.2</td>
<td>4.0</td>
<td>37.500000</td>
<td>15.154757</td>
<td>28.0</td>
<td>28.75</td>
<td>31.0</td>
<td>39.75</td>
<td>60.0</td>
<td>4.0</td>
<td>3.425000</td>
<td>...</td>
<td>2.100</td>
<td>3.9</td>
<td>4.0</td>
<td>0.475000</td>
<td>6.184658e-01</td>
<td>0.1</td>
<td>0.175</td>
<td>0.20</td>
<td>0.500</td>
<td>1.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.3</td>
<td>1.0</td>
<td>49.000000</td>
<td>NaN</td>
<td>49.0</td>
<td>49.00</td>
<td>49.0</td>
<td>49.00</td>
<td>49.0</td>
<td>1.0</td>
<td>3.700000</td>
<td>...</td>
<td>1.500</td>
<td>1.5</td>
<td>1.0</td>
<td>0.200000</td>
<td>NaN</td>
<td>0.2</td>
<td>0.200</td>
<td>0.20</td>
<td>0.200</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.4</td>
<td>6.0</td>
<td>28.666667</td>
<td>29.001149</td>
<td>6.0</td>
<td>12.50</td>
<td>19.0</td>
<td>29.25</td>
<td>85.0</td>
<td>6.0</td>
<td>3.550000</td>
<td>...</td>
<td>1.700</td>
<td>4.5</td>
<td>6.0</td>
<td>0.516667</td>
<td>4.915960e-01</td>
<td>0.2</td>
<td>0.250</td>
<td>0.40</td>
<td>0.400</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.5</td>
<td>7.0</td>
<td>67.000000</td>
<td>24.779023</td>
<td>34.0</td>
<td>45.50</td>
<td>81.0</td>
<td>86.00</td>
<td>91.0</td>
<td>7.0</td>
<td>2.842857</td>
<td>...</td>
<td>4.000</td>
<td>4.4</td>
<td>7.0</td>
<td>0.900000</td>
<td>4.898979e-01</td>
<td>0.2</td>
<td>0.600</td>
<td>1.10</td>
<td>1.250</td>
<td>1.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.6</td>
<td>6.0</td>
<td>84.666667</td>
<td>22.060523</td>
<td>65.0</td>
<td>67.75</td>
<td>79.5</td>
<td>93.50</td>
<td>122.0</td>
<td>6.0</td>
<td>2.816667</td>
<td>...</td>
<td>4.425</td>
<td>4.9</td>
<td>6.0</td>
<td>1.416667</td>
<td>3.125167e-01</td>
<td>1.1</td>
<td>1.300</td>
<td>1.30</td>
<td>1.450</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.7</td>
<td>8.0</td>
<td>72.250000</td>
<td>37.821951</td>
<td>16.0</td>
<td>46.75</td>
<td>88.0</td>
<td>97.75</td>
<td>114.0</td>
<td>8.0</td>
<td>3.100000</td>
<td>...</td>
<td>4.275</td>
<td>5.0</td>
<td>8.0</td>
<td>1.100000</td>
<td>5.451081e-01</td>
<td>0.3</td>
<td>0.850</td>
<td>1.25</td>
<td>1.300</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.8</td>
<td>7.0</td>
<td>88.428571</td>
<td>40.265192</td>
<td>15.0</td>
<td>75.50</td>
<td>93.0</td>
<td>108.50</td>
<td>143.0</td>
<td>7.0</td>
<td>2.885714</td>
<td>...</td>
<td>5.100</td>
<td>5.1</td>
<td>7.0</td>
<td>1.400000</td>
<td>7.280110e-01</td>
<td>0.2</td>
<td>1.100</td>
<td>1.20</td>
<td>1.900</td>
<td>2.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.9</td>
<td>3.0</td>
<td>94.333333</td>
<td>48.418316</td>
<td>62.0</td>
<td>66.50</td>
<td>71.0</td>
<td>110.50</td>
<td>150.0</td>
<td>3.0</td>
<td>3.066667</td>
<td>...</td>
<td>4.950</td>
<td>5.1</td>
<td>3.0</td>
<td>1.700000</td>
<td>1.732051e-01</td>
<td>1.5</td>
<td>1.650</td>
<td>1.80</td>
<td>1.800</td>
<td>1.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>6.0</td>
<td>95.166667</td>
<td>28.435307</td>
<td>63.0</td>
<td>80.25</td>
<td>85.0</td>
<td>111.50</td>
<td>139.0</td>
<td>6.0</td>
<td>2.733333</td>
<td>...</td>
<td>4.950</td>
<td>5.1</td>
<td>6.0</td>
<td>1.500000</td>
<td>2.683282e-01</td>
<td>1.0</td>
<td>1.500</td>
<td>1.55</td>
<td>1.600</td>
<td>1.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.1</td>
<td>6.0</td>
<td>94.166667</td>
<td>30.413265</td>
<td>64.0</td>
<td>72.50</td>
<td>83.0</td>
<td>119.00</td>
<td>135.0</td>
<td>6.0</td>
<td>2.850000</td>
<td>...</td>
<td>4.850</td>
<td>5.6</td>
<td>6.0</td>
<td>1.416667</td>
<td>2.041241e-01</td>
<td>1.2</td>
<td>1.325</td>
<td>1.40</td>
<td>1.400</td>
<td>1.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.2</td>
<td>4.0</td>
<td>110.750000</td>
<td>34.798228</td>
<td>69.0</td>
<td>90.75</td>
<td>112.5</td>
<td>132.50</td>
<td>149.0</td>
<td>4.0</td>
<td>2.825000</td>
<td>...</td>
<td>4.950</td>
<td>5.4</td>
<td>4.0</td>
<td>1.725000</td>
<td>4.349329e-01</td>
<td>1.3</td>
<td>1.450</td>
<td>1.65</td>
<td>1.925</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.3</td>
<td>9.0</td>
<td>107.222222</td>
<td>30.780586</td>
<td>57.0</td>
<td>88.00</td>
<td>104.0</td>
<td>134.00</td>
<td>147.0</td>
<td>9.0</td>
<td>2.855556</td>
<td>...</td>
<td>5.600</td>
<td>6.0</td>
<td>9.0</td>
<td>1.811111</td>
<td>4.075673e-01</td>
<td>1.3</td>
<td>1.500</td>
<td>1.80</td>
<td>1.900</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.4</td>
<td>7.0</td>
<td>107.857143</td>
<td>32.328669</td>
<td>52.0</td>
<td>93.50</td>
<td>116.0</td>
<td>131.00</td>
<td>138.0</td>
<td>7.0</td>
<td>2.957143</td>
<td>...</td>
<td>5.550</td>
<td>5.6</td>
<td>7.0</td>
<td>1.871429</td>
<td>3.683942e-01</td>
<td>1.3</td>
<td>1.650</td>
<td>1.90</td>
<td>2.150</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.5</td>
<td>5.0</td>
<td>107.200000</td>
<td>33.558903</td>
<td>55.0</td>
<td>105.00</td>
<td>111.0</td>
<td>117.00</td>
<td>148.0</td>
<td>5.0</td>
<td>3.000000</td>
<td>...</td>
<td>5.500</td>
<td>5.8</td>
<td>5.0</td>
<td>1.900000</td>
<td>2.645751e-01</td>
<td>1.5</td>
<td>1.800</td>
<td>2.00</td>
<td>2.000</td>
<td>2.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.6</td>
<td>2.0</td>
<td>67.500000</td>
<td>12.020815</td>
<td>59.0</td>
<td>63.25</td>
<td>67.5</td>
<td>71.75</td>
<td>76.0</td>
<td>2.0</td>
<td>2.950000</td>
<td>...</td>
<td>4.550</td>
<td>4.6</td>
<td>2.0</td>
<td>1.350000</td>
<td>7.071068e-02</td>
<td>1.3</td>
<td>1.325</td>
<td>1.35</td>
<td>1.375</td>
<td>1.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.7</td>
<td>8.0</td>
<td>112.125000</td>
<td>31.984092</td>
<td>66.0</td>
<td>84.75</td>
<td>117.0</td>
<td>142.00</td>
<td>146.0</td>
<td>8.0</td>
<td>3.050000</td>
<td>...</td>
<td>5.700</td>
<td>5.8</td>
<td>8.0</td>
<td>1.962500</td>
<td>4.206712e-01</td>
<td>1.4</td>
<td>1.650</td>
<td>1.95</td>
<td>2.325</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.8</td>
<td>3.0</td>
<td>111.333333</td>
<td>33.531080</td>
<td>77.0</td>
<td>95.00</td>
<td>113.0</td>
<td>128.50</td>
<td>144.0</td>
<td>3.0</td>
<td>3.000000</td>
<td>...</td>
<td>5.700</td>
<td>5.9</td>
<td>3.0</td>
<td>1.933333</td>
<td>4.725816e-01</td>
<td>1.4</td>
<td>1.750</td>
<td>2.10</td>
<td>2.200</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.9</td>
<td>4.0</td>
<td>114.000000</td>
<td>41.753243</td>
<td>53.0</td>
<td>104.00</td>
<td>130.5</td>
<td>140.50</td>
<td>142.0</td>
<td>4.0</td>
<td>3.125000</td>
<td>...</td>
<td>5.475</td>
<td>5.7</td>
<td>4.0</td>
<td>2.050000</td>
<td>3.785939e-01</td>
<td>1.5</td>
<td>1.950</td>
<td>2.20</td>
<td>2.300</td>
<td>2.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7.0</td>
<td>1.0</td>
<td>51.000000</td>
<td>NaN</td>
<td>51.0</td>
<td>51.00</td>
<td>51.0</td>
<td>51.00</td>
<td>51.0</td>
<td>1.0</td>
<td>3.200000</td>
<td>...</td>
<td>4.700</td>
<td>4.7</td>
<td>1.0</td>
<td>1.400000</td>
<td>NaN</td>
<td>1.4</td>
<td>1.400</td>
<td>1.40</td>
<td>1.400</td>
<td>1.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7.1</td>
<td>1.0</td>
<td>103.000000</td>
<td>NaN</td>
<td>103.0</td>
<td>103.00</td>
<td>103.0</td>
<td>103.00</td>
<td>103.0</td>
<td>1.0</td>
<td>3.000000</td>
<td>...</td>
<td>5.900</td>
<td>5.9</td>
<td>1.0</td>
<td>2.100000</td>
<td>NaN</td>
<td>2.1</td>
<td>2.100</td>
<td>2.10</td>
<td>2.100</td>
<td>2.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7.2</td>
<td>3.0</td>
<td>122.000000</td>
<td>10.583005</td>
<td>110.0</td>
<td>118.00</td>
<td>126.0</td>
<td>128.00</td>
<td>130.0</td>
<td>3.0</td>
<td>3.266667</td>
<td>...</td>
<td>6.050</td>
<td>6.1</td>
<td>3.0</td>
<td>1.966667</td>
<td>4.725816e-01</td>
<td>1.6</td>
<td>1.700</td>
<td>1.80</td>
<td>2.150</td>
<td>2.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7.3</td>
<td>1.0</td>
<td>108.000000</td>
<td>NaN</td>
<td>108.0</td>
<td>108.00</td>
<td>108.0</td>
<td>108.00</td>
<td>108.0</td>
<td>1.0</td>
<td>2.900000</td>
<td>...</td>
<td>6.300</td>
<td>6.3</td>
<td>1.0</td>
<td>1.800000</td>
<td>NaN</td>
<td>1.8</td>
<td>1.800</td>
<td>1.80</td>
<td>1.800</td>
<td>1.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7.4</td>
<td>1.0</td>
<td>131.000000</td>
<td>NaN</td>
<td>131.0</td>
<td>131.00</td>
<td>131.0</td>
<td>131.00</td>
<td>131.0</td>
<td>1.0</td>
<td>2.800000</td>
<td>...</td>
<td>6.100</td>
<td>6.1</td>
<td>1.0</td>
<td>1.900000</td>
<td>NaN</td>
<td>1.9</td>
<td>1.900</td>
<td>1.90</td>
<td>1.900</td>
<td>1.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7.6</td>
<td>1.0</td>
<td>106.000000</td>
<td>NaN</td>
<td>106.0</td>
<td>106.00</td>
<td>106.0</td>
<td>106.00</td>
<td>106.0</td>
<td>1.0</td>
<td>3.000000</td>
<td>...</td>
<td>6.600</td>
<td>6.6</td>
<td>1.0</td>
<td>2.100000</td>
<td>NaN</td>
<td>2.1</td>
<td>2.100</td>
<td>2.10</td>
<td>2.100</td>
<td>2.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7.7</td>
<td>4.0</td>
<td>124.000000</td>
<td>8.286535</td>
<td>118.0</td>
<td>118.75</td>
<td>121.0</td>
<td>126.25</td>
<td>136.0</td>
<td>4.0</td>
<td>3.050000</td>
<td>...</td>
<td>6.750</td>
<td>6.9</td>
<td>4.0</td>
<td>2.200000</td>
<td>1.414214e-01</td>
<td>2.0</td>
<td>2.150</td>
<td>2.25</td>
<td>2.300</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7.9</td>
<td>1.0</td>
<td>132.000000</td>
<td>NaN</td>
<td>132.0</td>
<td>132.00</td>
<td>132.0</td>
<td>132.00</td>
<td>132.0</td>
<td>1.0</td>
<td>3.800000</td>
<td>...</td>
<td>6.400</td>
<td>6.4</td>
<td>1.0</td>
<td>2.000000</td>
<td>NaN</td>
<td>2.0</td>
<td>2.000</td>
<td>2.00</td>
<td>2.000</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>35 rows × 32 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># invoking a method inside GroupBy</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(group):</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.describe()</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>grouped.<span class="bu">apply</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="8" data-quarto-table-cell-role="th" data-valign="top">a</td>
<td data-quarto-table-cell-role="th">count</td>
<td>2.0</td>
<td>2.000000</td>
<td>2.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>1.5</td>
<td>-0.023431</td>
<td>0.064271</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.707107</td>
<td>1.309280</td>
<td>1.305741</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.0</td>
<td>-0.949232</td>
<td>-0.859027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>1.25</td>
<td>-0.486331</td>
<td>-0.397378</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>1.5</td>
<td>-0.023431</td>
<td>0.064271</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>1.75</td>
<td>0.439470</td>
<td>0.525920</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>2.0</td>
<td>0.902370</td>
<td>0.987569</td>
</tr>
<tr class="odd">
<td rowspan="8" data-quarto-table-cell-role="th" data-valign="top">b</td>
<td data-quarto-table-cell-role="th">count</td>
<td>0.0</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>&lt;NA&gt;</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>&lt;NA&gt;</td>
<td>0.269996</td>
<td>0.291597</td>
</tr>
<tr class="odd">
<td rowspan="8" data-quarto-table-cell-role="th" data-valign="top">c</td>
<td data-quarto-table-cell-role="th">count</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>&lt;NA&gt;</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>5.0</td>
<td>-1.341779</td>
<td>-0.229023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>iris2.<span class="bu">apply</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>150.000000</td>
<td>150.000000</td>
<td>150.000000</td>
<td>150.000000</td>
<td>150.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>75.500000</td>
<td>5.843333</td>
<td>3.054000</td>
<td>3.758667</td>
<td>1.198667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>43.445368</td>
<td>0.828066</td>
<td>0.433594</td>
<td>1.764420</td>
<td>0.763161</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>4.300000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>0.100000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>38.250000</td>
<td>5.100000</td>
<td>2.800000</td>
<td>1.600000</td>
<td>0.300000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>75.500000</td>
<td>5.800000</td>
<td>3.000000</td>
<td>4.350000</td>
<td>1.300000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>112.750000</td>
<td>6.400000</td>
<td>3.300000</td>
<td>5.100000</td>
<td>1.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>150.000000</td>
<td>7.900000</td>
<td>4.400000</td>
<td>6.900000</td>
<td>2.500000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="suppressing-the-group-keys" class="level3">
<h3 class="anchored" data-anchor-id="suppressing-the-group-keys">Suppressing the Group Keys</h3>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>iris2.groupby(<span class="st">'Sepal Length (cm)'</span>, group_keys <span class="op">=</span> <span class="va">False</span>).<span class="bu">apply</span>(top)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>4.3</td>
<td>3.0</td>
<td>1.1</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>4.4</td>
<td>2.9</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>39</td>
<td>4.4</td>
<td>3.0</td>
<td>1.3</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42</td>
<td>43</td>
<td>4.4</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>42</td>
<td>4.5</td>
<td>2.3</td>
<td>1.3</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">117</td>
<td>118</td>
<td>7.7</td>
<td>3.8</td>
<td>6.7</td>
<td>2.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">118</td>
<td>119</td>
<td>7.7</td>
<td>2.6</td>
<td>6.9</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">122</td>
<td>123</td>
<td>7.7</td>
<td>2.8</td>
<td>6.7</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>136</td>
<td>7.7</td>
<td>3.0</td>
<td>6.1</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">131</td>
<td>132</td>
<td>7.9</td>
<td>3.8</td>
<td>6.4</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>120 rows × 5 columns</p>
</div>
</div>
</div>
</section>
<section id="quantile-and-bucket-analysis" class="level3">
<h3 class="anchored" data-anchor-id="quantile-and-bucket-analysis">Quantile and Bucket analysis</h3>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> pd.DataFrame({<span class="st">'data1'</span>: np.random.standard_normal(<span class="dv">1000</span>),</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'data2'</span>: np.random.standard_normal(<span class="dv">1000</span>)})</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>frame.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.218315</td>
<td>-1.593930</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.851876</td>
<td>0.110652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-2.136658</td>
<td>-0.057209</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.380738</td>
<td>-1.014417</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.375207</td>
<td>0.910869</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>quartiles <span class="op">=</span> pd.cut(frame[<span class="st">'data1'</span>],<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>quartiles.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>0     (-1.6, 0.127]
1    (1.854, 3.581]
2    (-3.333, -1.6]
3    (0.127, 1.854]
4    (0.127, 1.854]
Name: data1, dtype: category
Categories (4, interval[float64, right]): [(-3.333, -1.6] &lt; (-1.6, 0.127] &lt; (0.127, 1.854] &lt; (1.854, 3.581]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_stats(group):</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame({</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min'</span>: group.<span class="bu">min</span>(), <span class="st">'max'</span>:group.<span class="bu">max</span>(),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'count'</span>:group.count(), <span class="st">"mean"</span>:group.mean()</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>grouped3 <span class="op">=</span> frame.groupby(quartiles)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>grouped3.<span class="bu">apply</span>(get_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">(-3.333, -1.6]</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>-3.326377</td>
<td>-1.615895</td>
<td>47</td>
<td>-2.008459</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-2.449983</td>
<td>1.891096</td>
<td>47</td>
<td>-0.031678</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">(-1.6, 0.127]</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>-1.592835</td>
<td>0.127111</td>
<td>499</td>
<td>-0.559453</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-3.688831</td>
<td>2.891848</td>
<td>499</td>
<td>0.060442</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">(0.127, 1.854]</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>0.129218</td>
<td>1.845841</td>
<td>419</td>
<td>0.767489</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-3.107630</td>
<td>3.210868</td>
<td>419</td>
<td>0.063923</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">(1.854, 3.581]</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>1.860336</td>
<td>3.580781</td>
<td>35</td>
<td>2.272007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-1.915169</td>
<td>1.595983</td>
<td>35</td>
<td>-0.040774</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the same result can also be computed with;</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>grouped3.agg({<span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'count'</span>, <span class="st">'mean'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">data1</th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">(-3.333, -1.6]</td>
<td>-1.615895</td>
<td>47</td>
<td>-3.326377</td>
<td>-2.008459</td>
<td>1.891096</td>
<td>47</td>
<td>-2.449983</td>
<td>-0.031678</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(-1.6, 0.127]</td>
<td>0.127111</td>
<td>499</td>
<td>-1.592835</td>
<td>-0.559453</td>
<td>2.891848</td>
<td>499</td>
<td>-3.688831</td>
<td>0.060442</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(0.127, 1.854]</td>
<td>1.845841</td>
<td>419</td>
<td>0.129218</td>
<td>0.767489</td>
<td>3.210868</td>
<td>419</td>
<td>-3.107630</td>
<td>0.063923</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1.854, 3.581]</td>
<td>3.580781</td>
<td>35</td>
<td>1.860336</td>
<td>2.272007</td>
<td>1.595983</td>
<td>35</td>
<td>-1.915169</td>
<td>-0.040774</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using pandas.qcut</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>quartiles_samp <span class="op">=</span> pd.qcut(frame[<span class="st">'data1'</span>], <span class="dv">4</span>, labels<span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>quartiles_samp.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>0    1
1    3
2    0
3    3
4    2
Name: data1, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>grouped4 <span class="op">=</span> frame.groupby(quartiles_samp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>grouped4.<span class="bu">apply</span>(get_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>-3.326377</td>
<td>-0.634348</td>
<td>250</td>
<td>-1.220039</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-2.449983</td>
<td>2.891848</td>
<td>250</td>
<td>0.170686</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">1</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>-0.629175</td>
<td>0.018952</td>
<td>250</td>
<td>-0.288017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-2.673280</td>
<td>2.854084</td>
<td>250</td>
<td>-0.041068</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">2</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>0.023148</td>
<td>0.676789</td>
<td>250</td>
<td>0.326941</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-3.688831</td>
<td>3.210868</td>
<td>250</td>
<td>0.070652</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">3</td>
<td data-quarto-table-cell-role="th">data1</td>
<td>0.681385</td>
<td>3.580781</td>
<td>250</td>
<td>1.291250</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">data2</td>
<td>-3.107630</td>
<td>2.653283</td>
<td>250</td>
<td>0.015843</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ex-filling-missing-values-with-group-spscific-values" class="level3">
<h3 class="anchored" data-anchor-id="ex-filling-missing-values-with-group-spscific-values">Ex: Filling missing values with group-spscific values</h3>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">6</span>))</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>s[::<span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>0         NaN
1   -0.860730
2         NaN
3    1.412749
4         NaN
5    0.419197
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>s.fillna(s.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre><code>0    0.323739
1   -0.860730
2    0.323739
3    1.412749
4    0.323739
5    0.419197
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> [<span class="st">'MP'</span>, <span class="st">'UP'</span>, <span class="st">'MH'</span>, <span class="st">'RJ'</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">'HP'</span>, <span class="st">'UK'</span>, <span class="st">'PB'</span>, <span class="st">'KR'</span>]</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>group_key <span class="op">=</span> [<span class="st">'Centre'</span>, <span class="st">'Centre'</span>, <span class="st">'Centre'</span>, <span class="st">'Centre'</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'North'</span>, <span class="st">'North'</span>, <span class="st">"North"</span>, <span class="st">"North"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>data4 <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">8</span>),</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                index<span class="op">=</span> states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>data4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<pre><code>MP    0.712152
UP    0.211319
MH    0.925109
RJ   -0.204536
HP    0.293047
UK    0.497221
PB    0.034935
KR   -0.842300
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># missing data for states</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>data4[[<span class="st">'MP'</span>, <span class="st">"PB"</span>, <span class="st">"KR"</span>]] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>data4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre><code>MP         NaN
UP    0.211319
MH    0.925109
RJ   -0.204536
HP    0.293047
UK    0.497221
PB         NaN
KR         NaN
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>data4.groupby(group_key).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>Centre    4
North     4
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>data4.groupby(group_key).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<pre><code>Centre    0.310630
North     0.395134
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>data4.groupby(group_key).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>Centre    3
North     2
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>data4.groupby(group_key).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>Centre    0.310630
North     0.395134
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filling NA values from group means</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_mean(group):</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.fillna(group.mean())</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>data.groupby(group_key).<span class="bu">apply</span>(fill_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>Centre  MP   -1.190913
        UP    0.136560
        MH   -0.046813
        RJ    0.962568
North   HP    0.477671
        UK   -0.695437
        PB    0.745012
        KR    2.058104
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>MP   -1.190913
UP    0.136560
MH   -0.046813
RJ    0.962568
HP    0.477671
UK   -0.695437
PB    0.745012
KR    2.058104
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>data4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<pre><code>MP         NaN
UP    0.211319
MH    0.925109
RJ   -0.204536
HP    0.293047
UK    0.497221
PB         NaN
KR         NaN
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filling predefined vlaues</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>fill_values <span class="op">=</span> {<span class="st">'Centre'</span>: <span class="fl">0.5</span>,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'North'</span>: <span class="op">-</span><span class="dv">1</span>}</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_func(group):</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.fillna(fill_values[group.name])</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>data4.groupby(group_key).<span class="bu">apply</span>(fill_func)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="173">
<pre><code>Centre  MP    0.500000
        UP    0.211319
        MH    0.925109
        RJ   -0.204536
North   HP    0.293047
        UK    0.497221
        PB   -1.000000
        KR   -1.000000
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="ex-random-sampling-and-permutation" class="level3">
<h3 class="anchored" data-anchor-id="ex-random-sampling-and-permutation">Ex: Random Sampling and Permutation</h3>
<div class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>suits <span class="op">=</span> [<span class="st">'H'</span>, <span class="st">'S'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>] <span class="co"># hearts, club, diammonds, spades</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>card_val <span class="op">=</span> (<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)) <span class="op">+</span> [<span class="dv">10</span>] <span class="op">*</span> <span class="dv">3</span>) <span class="op">*</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>base_names <span class="op">=</span> [<span class="st">'A'</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">11</span>)) <span class="op">+</span> [<span class="st">'J'</span>, <span class="st">'K'</span>, <span class="st">'Q'</span>]</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>cards <span class="op">=</span> []</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> suit <span class="kw">in</span> suits:</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    cards.extend(<span class="bu">str</span>(num) <span class="op">+</span> suit <span class="cf">for</span> num <span class="kw">in</span> base_names)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>deck<span class="op">=</span> pd.Series(card_val, index <span class="op">=</span> cards)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>deck.head(<span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>AH      1
2H      2
3H      3
4H      4
5H      5
6H      6
7H      7
8H      8
9H      9
10H    10
JH     10
KH     10
QH     10
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drawing first five cards from deck </span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw(deck, n<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> deck.sample(n)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>draw(deck)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>6H      6
6S      6
7S      7
10H    10
9D      9
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two random cards from each suit</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_suit(card):</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># last letter is suit</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> card[<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>deck.groupby(get_suit).<span class="bu">apply</span>(draw, n <span class="op">=</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">
<pre><code>C  KC    10
   AC     1
D  JD    10
   6D     6
H  AH     1
   2H     2
S  9S     9
   AS     1
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively, group_keys = False</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>deck.groupby(get_suit, group_keys<span class="op">=</span> <span class="va">False</span>).<span class="bu">apply</span>(draw, n<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">
<pre><code>4C     4
KC    10
6D     6
JD    10
8H     8
AH     1
JS    10
8S     8
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="ex-group-weighted-average-and-correlation" class="level3">
<h3 class="anchored" data-anchor-id="ex-group-weighted-average-and-correlation">Ex: Group weighted Average and Correlation</h3>
<div class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>df5 <span class="op">=</span> pd.DataFrame({<span class="st">"category"</span>: [<span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>],</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"data"</span>: np.random.standard_normal(<span class="dv">4</span>),</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'weights'</span>: np.random.uniform(size <span class="op">=</span> <span class="dv">4</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>df5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="184">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">data</th>
<th data-quarto-table-cell-role="th">weights</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>-0.272834</td>
<td>0.453331</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>a</td>
<td>1.032855</td>
<td>0.573681</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>a</td>
<td>0.123029</td>
<td>0.239600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>a</td>
<td>-0.715634</td>
<td>0.474301</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average weight by category</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> df5.groupby(<span class="st">'category'</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_wavg(group):</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.average(group[<span class="st">'data'</span>],</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>                     weights<span class="op">=</span>group[<span class="st">'weights'</span>])</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>grouped.<span class="bu">apply</span>(get_wavg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="185">
<pre><code>category
a    0.091272
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="ex-group-wise-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="ex-group-wise-linear-regression">Ex: Group-Wise linear Regression</h3>
<ul>
<li>using regress function of statsmodel econometrics library</li>
</ul>
<div class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> pip install statsmodels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regress(data, yvar<span class="op">=</span> <span class="va">None</span>, xvars <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> data[yvar]</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> data [xvar]</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    X[<span class="st">'intercept'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result.params</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>iris2.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>Index(['Id', 'Sepal Length (cm)', 'Sepal Width (cm)', 'Petal Length (cm)',
       'Petal Width (cm)'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>iris2.rename(columns<span class="op">=</span>{<span class="st">'Sepal Length (cm)'</span> : <span class="st">'sepal_length'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>iris2.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>Index(['Id', 'sepal_length', 'Sepal Width (cm)', 'Petal Length (cm)',
       'Petal Width (cm)'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>sepal_length.<span class="bu">apply</span>(regress, yvar<span class="op">=</span> <span class="st">"AAPl"</span>, </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>             xvars <span class="op">=</span> [<span class="st">"SPX"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-transforms-and-unwrapped-groupbys" class="level3">
<h3 class="anchored" data-anchor-id="group-transforms-and-unwrapped-groupbys">Group transforms and ‘Unwrapped’ GroupBys</h3>
<div class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>df6 <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>] <span class="op">*</span> <span class="dv">4</span>,</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'value'</span> : np.arange(<span class="fl">12.</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>                   })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>df6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>b</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>c</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>a</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>b</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>c</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>a</td>
<td>6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>b</td>
<td>7.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>c</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>a</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>b</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>c</td>
<td>11.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group means by key</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> df6.groupby(<span class="st">'key'</span>)[<span class="st">'value'</span>]</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>g.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="203">
<pre><code>key
a    4.5
b    5.5
c    6.5
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_mean(group):</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.mean()</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>g.transform(get_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="205">
<pre><code>0     4.5
1     5.5
2     6.5
3     4.5
4     5.5
5     6.5
6     4.5
7     5.5
8     6.5
9     4.5
10    5.5
11    6.5
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>g.transform(<span class="st">'mean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="207">
<pre><code>0     4.5
1     5.5
2     6.5
3     4.5
4     5.5
5     6.5
6     4.5
7     5.5
8     6.5
9     4.5
10    5.5
11    6.5
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> times_two(group):</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group<span class="op">*</span> <span class="dv">2</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>g.transform(times_two)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="208">
<pre><code>0      0.0
1      2.0
2      4.0
3      6.0
4      8.0
5     10.0
6     12.0
7     14.0
8     16.0
9     18.0
10    20.0
11    22.0
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ranks in descending order</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_ranks(group):</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>g.transform(get_ranks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="210">
<pre><code>0     4.0
1     4.0
2     4.0
3     3.0
4     3.0
5     3.0
6     2.0
7     2.0
8     2.0
9     1.0
10    1.0
11    1.0
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformation function composed of aggregations</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize(x):</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean())<span class="op">/</span>x.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>g.transform(normalize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<pre><code>0    -1.161895
1    -1.161895
2    -1.161895
3    -0.387298
4    -0.387298
5    -0.387298
6     0.387298
7     0.387298
8     0.387298
9     1.161895
10    1.161895
11    1.161895
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>g.<span class="bu">apply</span>(normalize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="213">
<pre><code>key    
a    0    -1.161895
     3    -0.387298
     6     0.387298
     9     1.161895
b    1    -1.161895
     4    -0.387298
     7     0.387298
     10    1.161895
c    2    -1.161895
     5    -0.387298
     8     0.387298
     11    1.161895
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using built-in 'mean' and 'sum' functions</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>g.transform(<span class="st">'mean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="214">
<pre><code>0     4.5
1     5.5
2     6.5
3     4.5
4     5.5
5     6.5
6     4.5
7     5.5
8     6.5
9     4.5
10    5.5
11    6.5
Name: value, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>normalized2 <span class="op">=</span> (df6[<span class="st">'value'</span>] <span class="op">-</span> g.transform(<span class="st">'mean'</span>)) <span class="op">/</span> g.transform(<span class="st">'std'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>normalized2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="216">
<pre><code>0    -1.161895
1    -1.161895
2    -1.161895
3    -0.387298
4    -0.387298
5    -0.387298
6     0.387298
7     0.387298
8     0.387298
9     1.161895
10    1.161895
11    1.161895
Name: value, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="pivot-tables" class="level3">
<h3 class="anchored" data-anchor-id="pivot-tables">Pivot tables</h3>
<ul>
<li>summarization tool</li>
<li>uses groupby facility</li>
<li>pandas.pivot_table fucntion can add partial tools known as margins</li>
<li><a href="https://learning.oreilly.com/library/view/python-for-data/9781098104023/ch10.html#table_pivot_table">summary - pivot table</a></li>
</ul>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> mlt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>df_iris <span class="op">=</span> pd.read_csv(<span class="st">'E:\pythonfordatanalysis\semainedu26fevrier\iris.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>df_iris.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
<th data-quarto-table-cell-role="th">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>4.6</td>
<td>3.1</td>
<td>1.5</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>5.0</td>
<td>3.6</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>df_iris.pivot_table(index <span class="op">=</span> [<span class="st">'Species'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Species</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Iris-setosa</td>
<td>25.5</td>
<td>1.464</td>
<td>0.244</td>
<td>5.006</td>
<td>3.418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Iris-versicolor</td>
<td>75.5</td>
<td>4.260</td>
<td>1.326</td>
<td>5.936</td>
<td>2.770</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Iris-virginica</td>
<td>125.5</td>
<td>5.552</td>
<td>2.026</td>
<td>6.588</td>
<td>2.974</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>df_iris.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Index(['Id', 'Sepal Length (cm)', 'Sepal Width (cm)', 'Petal Length (cm)',
       'Petal Width (cm)', 'Species'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>df_iris.pivot_table(index <span class="op">=</span> [<span class="st">'Species'</span>, <span class="st">'Petal Length (cm)'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Id</th>
<th data-quarto-table-cell-role="th">Petal Width (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Length (cm)</th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Species</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="9" data-quarto-table-cell-role="th" data-valign="top">Iris-setosa</td>
<td data-quarto-table-cell-role="th">1.0</td>
<td>23.000000</td>
<td>0.200000</td>
<td>4.600000</td>
<td>3.600000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.1</td>
<td>14.000000</td>
<td>0.100000</td>
<td>4.300000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.2</td>
<td>25.500000</td>
<td>0.200000</td>
<td>5.400000</td>
<td>3.600000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.3</td>
<td>31.714286</td>
<td>0.257143</td>
<td>4.842857</td>
<td>3.228571</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.4</td>
<td>21.833333</td>
<td>0.216667</td>
<td>4.916667</td>
<td>3.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.5</td>
<td>24.714286</td>
<td>0.221429</td>
<td>5.128571</td>
<td>3.535714</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.6</td>
<td>31.000000</td>
<td>0.285714</td>
<td>4.914286</td>
<td>3.342857</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.7</td>
<td>17.500000</td>
<td>0.350000</td>
<td>5.400000</td>
<td>3.600000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.9</td>
<td>35.000000</td>
<td>0.300000</td>
<td>4.950000</td>
<td>3.600000</td>
</tr>
<tr class="even">
<td rowspan="19" data-quarto-table-cell-role="th" data-valign="top">Iris-versicolor</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>99.000000</td>
<td>1.100000</td>
<td>5.100000</td>
<td>2.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.3</td>
<td>76.000000</td>
<td>1.000000</td>
<td>4.950000</td>
<td>2.350000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.5</td>
<td>70.500000</td>
<td>1.000000</td>
<td>5.350000</td>
<td>2.300000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.6</td>
<td>65.000000</td>
<td>1.300000</td>
<td>5.600000</td>
<td>2.900000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.7</td>
<td>82.000000</td>
<td>1.000000</td>
<td>5.500000</td>
<td>2.400000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.8</td>
<td>81.000000</td>
<td>1.100000</td>
<td>5.500000</td>
<td>2.400000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.9</td>
<td>71.000000</td>
<td>1.233333</td>
<td>5.533333</td>
<td>2.633333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.0</td>
<td>74.400000</td>
<td>1.220000</td>
<td>5.780000</td>
<td>2.480000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.1</td>
<td>85.666667</td>
<td>1.200000</td>
<td>5.700000</td>
<td>2.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.2</td>
<td>87.500000</td>
<td>1.325000</td>
<td>5.725000</td>
<td>2.900000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.3</td>
<td>86.500000</td>
<td>1.300000</td>
<td>6.300000</td>
<td>2.900000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.4</td>
<td>80.250000</td>
<td>1.325000</td>
<td>6.275000</td>
<td>2.750000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.5</td>
<td>70.571429</td>
<td>1.485714</td>
<td>5.900000</td>
<td>2.928571</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.6</td>
<td>68.666667</td>
<td>1.400000</td>
<td>6.400000</td>
<td>2.900000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.7</td>
<td>66.600000</td>
<td>1.420000</td>
<td>6.440000</td>
<td>3.060000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.8</td>
<td>74.000000</td>
<td>1.600000</td>
<td>6.350000</td>
<td>3.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.9</td>
<td>63.000000</td>
<td>1.500000</td>
<td>6.600000</td>
<td>2.800000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.0</td>
<td>78.000000</td>
<td>1.700000</td>
<td>6.700000</td>
<td>3.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.1</td>
<td>84.000000</td>
<td>1.600000</td>
<td>6.000000</td>
<td>2.700000</td>
</tr>
<tr class="odd">
<td rowspan="20" data-quarto-table-cell-role="th" data-valign="top">Iris-virginica</td>
<td data-quarto-table-cell-role="th">4.5</td>
<td>107.000000</td>
<td>1.700000</td>
<td>4.900000</td>
<td>2.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.8</td>
<td>133.000000</td>
<td>1.800000</td>
<td>6.100000</td>
<td>2.900000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.9</td>
<td>124.666667</td>
<td>1.866667</td>
<td>6.000000</td>
<td>2.833333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.0</td>
<td>127.000000</td>
<td>1.800000</td>
<td>6.000000</td>
<td>2.400000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.1</td>
<td>128.142857</td>
<td>1.971429</td>
<td>6.142857</td>
<td>2.900000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.2</td>
<td>147.000000</td>
<td>2.150000</td>
<td>6.600000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.3</td>
<td>114.000000</td>
<td>2.100000</td>
<td>6.400000</td>
<td>2.950000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.4</td>
<td>144.500000</td>
<td>2.200000</td>
<td>6.550000</td>
<td>3.250000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.5</td>
<td>122.666667</td>
<td>1.900000</td>
<td>6.566667</td>
<td>3.033333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.6</td>
<td>129.833333</td>
<td>2.050000</td>
<td>6.366667</td>
<td>2.933333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.7</td>
<td>130.333333</td>
<td>2.300000</td>
<td>6.766667</td>
<td>3.266667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.8</td>
<td>114.666667</td>
<td>1.866667</td>
<td>6.800000</td>
<td>2.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.9</td>
<td>123.500000</td>
<td>2.200000</td>
<td>6.950000</td>
<td>3.100000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>113.500000</td>
<td>2.150000</td>
<td>6.750000</td>
<td>3.250000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.1</td>
<td>125.666667</td>
<td>2.233333</td>
<td>7.433333</td>
<td>3.133333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.3</td>
<td>108.000000</td>
<td>1.800000</td>
<td>7.300000</td>
<td>2.900000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.4</td>
<td>132.000000</td>
<td>2.000000</td>
<td>7.900000</td>
<td>3.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.6</td>
<td>106.000000</td>
<td>2.100000</td>
<td>7.600000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.7</td>
<td>120.500000</td>
<td>2.100000</td>
<td>7.700000</td>
<td>3.300000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.9</td>
<td>119.000000</td>
<td>2.300000</td>
<td>7.700000</td>
<td>2.600000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>df_iris.pivot_table(index <span class="op">=</span> [<span class="st">'Species'</span>, <span class="st">'Petal Length (cm)'</span>],</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                   columns <span class="op">=</span> <span class="st">'Sepal Width (cm)'</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">Id</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">Sepal Length (cm)</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">2.0</th>
<th data-quarto-table-cell-role="th">2.2</th>
<th data-quarto-table-cell-role="th">2.3</th>
<th data-quarto-table-cell-role="th">2.4</th>
<th data-quarto-table-cell-role="th">2.5</th>
<th data-quarto-table-cell-role="th">2.6</th>
<th data-quarto-table-cell-role="th">2.7</th>
<th data-quarto-table-cell-role="th">2.8</th>
<th data-quarto-table-cell-role="th">2.9</th>
<th data-quarto-table-cell-role="th">3.0</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">3.4</th>
<th data-quarto-table-cell-role="th">3.5</th>
<th data-quarto-table-cell-role="th">3.6</th>
<th data-quarto-table-cell-role="th">3.7</th>
<th data-quarto-table-cell-role="th">3.8</th>
<th data-quarto-table-cell-role="th">3.9</th>
<th data-quarto-table-cell-role="th">4.0</th>
<th data-quarto-table-cell-role="th">4.1</th>
<th data-quarto-table-cell-role="th">4.2</th>
<th data-quarto-table-cell-role="th">4.4</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Species</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="9" data-quarto-table-cell-role="th" data-valign="top">Iris-setosa</td>
<td data-quarto-table-cell-role="th">1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>4.6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>14.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.3</td>
<td>NaN</td>
<td>NaN</td>
<td>42.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>39.000000</td>
<td>...</td>
<td>NaN</td>
<td>5.25</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>9.0</td>
<td>20.333333</td>
<td>...</td>
<td>4.900000</td>
<td>5.10</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.5</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>5.166667</td>
<td>5.20</td>
<td>NaN</td>
<td>5.266667</td>
<td>5.1</td>
<td>NaN</td>
<td>NaN</td>
<td>5.2</td>
<td>NaN</td>
<td>5.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>26.000000</td>
<td>...</td>
<td>4.900000</td>
<td>5.00</td>
<td>NaN</td>
<td>NaN</td>
<td>5.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>5.400000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.7</td>
<td>5.4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>4.800000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td rowspan="19" data-quarto-table-cell-role="th" data-valign="top">Iris-versicolor</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>99.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.3</td>
<td>NaN</td>
<td>NaN</td>
<td>94.0</td>
<td>58.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.5</td>
<td>61.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>80.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>65.0</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>82.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>81.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>70.0</td>
<td>NaN</td>
<td>71.5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.0</td>
<td>NaN</td>
<td>63.0</td>
<td>54.0</td>
<td>NaN</td>
<td>90.0</td>
<td>93.0</td>
<td>NaN</td>
<td>72.0</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>68.0</td>
<td>100.0</td>
<td>NaN</td>
<td>89.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>95.0</td>
<td>NaN</td>
<td>97.0</td>
<td>79.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>86.5</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.4</td>
<td>NaN</td>
<td>NaN</td>
<td>88.0</td>
<td>NaN</td>
<td>NaN</td>
<td>91.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>76.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.5</td>
<td>NaN</td>
<td>69.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>56.0</td>
<td>79.0</td>
<td>76.000000</td>
<td>...</td>
<td>6.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>55.0</td>
<td>59.0</td>
<td>92.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>74.0</td>
<td>64.0</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>77.0</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>73.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>78.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>84.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td rowspan="20" data-quarto-table-cell-role="th" data-valign="top">Iris-virginica</td>
<td data-quarto-table-cell-role="th">4.5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>107.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>127.0</td>
<td>NaN</td>
<td>139.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>124.0</td>
<td>122.0</td>
<td>NaN</td>
<td>128.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.0</td>
<td>NaN</td>
<td>120.0</td>
<td>NaN</td>
<td>NaN</td>
<td>130.5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>122.5</td>
<td>124.5</td>
<td>NaN</td>
<td>150.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>147.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>112.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>6.200000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>115.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>135.0</td>
<td>NaN</td>
<td>131.0</td>
<td>104.0</td>
<td>NaN</td>
<td>...</td>
<td>6.300000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>109.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>117.500000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>103.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>131.0</td>
<td>NaN</td>
<td>136.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>7.2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>108.0</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>106.000000</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>123.0</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>119.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>48 rows × 69 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># passing fill_value for empty combinations</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>df_iris.pivot_table(index <span class="op">=</span> [<span class="st">'Species'</span>, <span class="st">'Petal Length (cm)'</span>],</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>                   columns <span class="op">=</span> <span class="st">'Sepal Width (cm)'</span>, fill_value<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">Id</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">Sepal Length (cm)</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sepal Width (cm)</th>
<th data-quarto-table-cell-role="th">2.0</th>
<th data-quarto-table-cell-role="th">2.2</th>
<th data-quarto-table-cell-role="th">2.3</th>
<th data-quarto-table-cell-role="th">2.4</th>
<th data-quarto-table-cell-role="th">2.5</th>
<th data-quarto-table-cell-role="th">2.6</th>
<th data-quarto-table-cell-role="th">2.7</th>
<th data-quarto-table-cell-role="th">2.8</th>
<th data-quarto-table-cell-role="th">2.9</th>
<th data-quarto-table-cell-role="th">3.0</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">3.4</th>
<th data-quarto-table-cell-role="th">3.5</th>
<th data-quarto-table-cell-role="th">3.6</th>
<th data-quarto-table-cell-role="th">3.7</th>
<th data-quarto-table-cell-role="th">3.8</th>
<th data-quarto-table-cell-role="th">3.9</th>
<th data-quarto-table-cell-role="th">4.0</th>
<th data-quarto-table-cell-role="th">4.1</th>
<th data-quarto-table-cell-role="th">4.2</th>
<th data-quarto-table-cell-role="th">4.4</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Species</th>
<th data-quarto-table-cell-role="th">Petal Length (cm)</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="9" data-quarto-table-cell-role="th" data-valign="top">Iris-setosa</td>
<td data-quarto-table-cell-role="th">1.0</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>4.6</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>14.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.8</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.3</td>
<td>5</td>
<td>5</td>
<td>42</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>39.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.25</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.4</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.4</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>9.0</td>
<td>20.333333</td>
<td>...</td>
<td>4.900000</td>
<td>5.10</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.5</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.166667</td>
<td>5.20</td>
<td>5.0</td>
<td>5.266667</td>
<td>5.1</td>
<td>5.0</td>
<td>5.0</td>
<td>5.2</td>
<td>5.0</td>
<td>5.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.6</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>26.000000</td>
<td>...</td>
<td>4.900000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.1</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.7</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.400000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.7</td>
<td>5.4</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.9</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>4.800000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.1</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td rowspan="19" data-quarto-table-cell-role="th" data-valign="top">Iris-versicolor</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>99.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.3</td>
<td>5</td>
<td>5</td>
<td>94</td>
<td>58</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.5</td>
<td>61</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>80</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.6</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>65.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.7</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>82</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.8</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>81</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3.9</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>70.0</td>
<td>5</td>
<td>71.5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.0</td>
<td>5</td>
<td>63</td>
<td>54</td>
<td>5</td>
<td>90.0</td>
<td>93</td>
<td>5.0</td>
<td>72.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>68.0</td>
<td>100.0</td>
<td>5.0</td>
<td>89.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>95.0</td>
<td>5.0</td>
<td>97.0</td>
<td>79.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.3</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>86.5</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.4</td>
<td>5</td>
<td>5</td>
<td>88</td>
<td>5</td>
<td>5.0</td>
<td>91</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>76.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.5</td>
<td>5</td>
<td>69</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>56.0</td>
<td>79.0</td>
<td>76.000000</td>
<td>...</td>
<td>6.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.6</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>55.0</td>
<td>59.0</td>
<td>92.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.7</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>74.0</td>
<td>64.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.8</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>77.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.9</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>73.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.0</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>78.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>84.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td rowspan="20" data-quarto-table-cell-role="th" data-valign="top">Iris-virginica</td>
<td data-quarto-table-cell-role="th">4.5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>107.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.8</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>127.0</td>
<td>5.0</td>
<td>139.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4.9</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>124.0</td>
<td>122.0</td>
<td>5.0</td>
<td>128.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.0</td>
<td>5</td>
<td>120</td>
<td>5</td>
<td>5</td>
<td>130.5</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>122.5</td>
<td>124.5</td>
<td>5.0</td>
<td>150.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>147.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.3</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>112.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.4</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>6.200000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>115.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.6</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>135</td>
<td>5.0</td>
<td>131.0</td>
<td>104.0</td>
<td>5.000000</td>
<td>...</td>
<td>6.300000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.7</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5.8</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>109.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>117.500000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.9</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>103.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>131.0</td>
<td>5.0</td>
<td>136.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>7.2</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.3</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>108.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.4</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>7.9</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.6</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>106.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.7</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>5</td>
<td>5.0</td>
<td>123.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>7.7</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.9</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5.0</td>
<td>119</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>...</td>
<td>5.000000</td>
<td>5.00</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
</tbody>
</table>

<p>48 rows × 69 columns</p>
</div>
</div>
</div>
</section>
<section id="cross--tabulation" class="level3">
<h3 class="anchored" data-anchor-id="cross--tabulation">Cross- tabulation</h3>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="st">""" Sample Court_paragraph</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="st">1. Il était une fois, dans un village paisible au bord de la mer, </span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="st">2. un jeune garçon nommé Luca. </span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="st">3. Luca aimait explorer les forêts environnantes, </span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="st">4. où il découvrait des trésors cachés et des mystères oubliés. </span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="st">5. Un jour, en suivant un papillon multicolore, </span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="st">6. Luca découvrit une grotte secrète.</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="st">7. À l'intérieur, il trouva une carte ancienne indiquant </span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="st">8. l'emplacement d'un trésor légendaire. </span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="st">9. Déterminé à le trouver, </span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a><span class="st">10. Luca partit en voyage, bravant des tempêtes et affrontant</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="st">11. des créatures magiques. </span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="st">12. Après de nombreuses aventures, il trouva enfin le trésor, </span></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a><span class="st">13. qui se révéla être l'amitié des habitants de ce village enchanté. </span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a><span class="st">14. Luca apprit alors que les véritables trésors </span></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a><span class="st">15. sont souvent cachés à l'intérieur de nous-mêmes.</span></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_table(StringIO(data), sep <span class="op">=</span> <span class="st">'\s+'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sample</th>
<th data-quarto-table-cell-role="th">Court_paragraph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.0</td>
<td data-quarto-table-cell-role="th">Il</td>
<td data-quarto-table-cell-role="th">était</td>
<td data-quarto-table-cell-role="th">une</td>
<td data-quarto-table-cell-role="th">fois,</td>
<td data-quarto-table-cell-role="th">dans</td>
<td data-quarto-table-cell-role="th">un</td>
<td data-quarto-table-cell-role="th">village</td>
<td data-quarto-table-cell-role="th">paisible</td>
<td data-quarto-table-cell-role="th">au</td>
<td data-quarto-table-cell-role="th">bord</td>
<td data-quarto-table-cell-role="th">de</td>
<td>la</td>
<td>mer,</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2.0</td>
<td data-quarto-table-cell-role="th">un</td>
<td data-quarto-table-cell-role="th">jeune</td>
<td data-quarto-table-cell-role="th">garçon</td>
<td data-quarto-table-cell-role="th">nommé</td>
<td data-quarto-table-cell-role="th">Luca.</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.0</td>
<td data-quarto-table-cell-role="th">Luca</td>
<td data-quarto-table-cell-role="th">aimait</td>
<td data-quarto-table-cell-role="th">explorer</td>
<td data-quarto-table-cell-role="th">les</td>
<td data-quarto-table-cell-role="th">forêts</td>
<td data-quarto-table-cell-role="th">environnantes,</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4.0</td>
<td data-quarto-table-cell-role="th">où</td>
<td data-quarto-table-cell-role="th">il</td>
<td data-quarto-table-cell-role="th">découvrait</td>
<td data-quarto-table-cell-role="th">des</td>
<td data-quarto-table-cell-role="th">trésors</td>
<td data-quarto-table-cell-role="th">cachés</td>
<td data-quarto-table-cell-role="th">et</td>
<td data-quarto-table-cell-role="th">des</td>
<td data-quarto-table-cell-role="th">mystères</td>
<td data-quarto-table-cell-role="th">oubliés.</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5.0</td>
<td data-quarto-table-cell-role="th">Un</td>
<td data-quarto-table-cell-role="th">jour,</td>
<td data-quarto-table-cell-role="th">en</td>
<td data-quarto-table-cell-role="th">suivant</td>
<td data-quarto-table-cell-role="th">un</td>
<td data-quarto-table-cell-role="th">papillon</td>
<td data-quarto-table-cell-role="th">multicolore,</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td data-quarto-table-cell-role="th">Luca</td>
<td data-quarto-table-cell-role="th">découvrit</td>
<td data-quarto-table-cell-role="th">une</td>
<td data-quarto-table-cell-role="th">grotte</td>
<td data-quarto-table-cell-role="th">secrète.</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7.0</td>
<td data-quarto-table-cell-role="th">À</td>
<td data-quarto-table-cell-role="th">l'intérieur,</td>
<td data-quarto-table-cell-role="th">il</td>
<td data-quarto-table-cell-role="th">trouva</td>
<td data-quarto-table-cell-role="th">une</td>
<td data-quarto-table-cell-role="th">carte</td>
<td data-quarto-table-cell-role="th">ancienne</td>
<td data-quarto-table-cell-role="th">indiquant</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8.0</td>
<td data-quarto-table-cell-role="th">l'emplacement</td>
<td data-quarto-table-cell-role="th">d'un</td>
<td data-quarto-table-cell-role="th">trésor</td>
<td data-quarto-table-cell-role="th">légendaire.</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9.0</td>
<td data-quarto-table-cell-role="th">Déterminé</td>
<td data-quarto-table-cell-role="th">à</td>
<td data-quarto-table-cell-role="th">le</td>
<td data-quarto-table-cell-role="th">trouver,</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10.0</td>
<td data-quarto-table-cell-role="th">Luca</td>
<td data-quarto-table-cell-role="th">partit</td>
<td data-quarto-table-cell-role="th">en</td>
<td data-quarto-table-cell-role="th">voyage,</td>
<td data-quarto-table-cell-role="th">bravant</td>
<td data-quarto-table-cell-role="th">des</td>
<td data-quarto-table-cell-role="th">tempêtes</td>
<td data-quarto-table-cell-role="th">et</td>
<td data-quarto-table-cell-role="th">affrontant</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11.0</td>
<td data-quarto-table-cell-role="th">des</td>
<td data-quarto-table-cell-role="th">créatures</td>
<td data-quarto-table-cell-role="th">magiques.</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td data-quarto-table-cell-role="th">Après</td>
<td data-quarto-table-cell-role="th">de</td>
<td data-quarto-table-cell-role="th">nombreuses</td>
<td data-quarto-table-cell-role="th">aventures,</td>
<td data-quarto-table-cell-role="th">il</td>
<td data-quarto-table-cell-role="th">trouva</td>
<td data-quarto-table-cell-role="th">enfin</td>
<td data-quarto-table-cell-role="th">le</td>
<td data-quarto-table-cell-role="th">trésor,</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13.0</td>
<td data-quarto-table-cell-role="th">qui</td>
<td data-quarto-table-cell-role="th">se</td>
<td data-quarto-table-cell-role="th">révéla</td>
<td data-quarto-table-cell-role="th">être</td>
<td data-quarto-table-cell-role="th">l'amitié</td>
<td data-quarto-table-cell-role="th">des</td>
<td data-quarto-table-cell-role="th">habitants</td>
<td data-quarto-table-cell-role="th">de</td>
<td data-quarto-table-cell-role="th">ce</td>
<td data-quarto-table-cell-role="th">village</td>
<td data-quarto-table-cell-role="th">enchanté.</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14.0</td>
<td data-quarto-table-cell-role="th">Luca</td>
<td data-quarto-table-cell-role="th">apprit</td>
<td data-quarto-table-cell-role="th">alors</td>
<td data-quarto-table-cell-role="th">que</td>
<td data-quarto-table-cell-role="th">les</td>
<td data-quarto-table-cell-role="th">véritables</td>
<td data-quarto-table-cell-role="th">trésors</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15.0</td>
<td data-quarto-table-cell-role="th">sont</td>
<td data-quarto-table-cell-role="th">souvent</td>
<td data-quarto-table-cell-role="th">cachés</td>
<td data-quarto-table-cell-role="th">à</td>
<td data-quarto-table-cell-role="th">l'intérieur</td>
<td data-quarto-table-cell-role="th">de</td>
<td data-quarto-table-cell-role="th">nous-mêmes.</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td data-quarto-table-cell-role="th">NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>pd.crosstab(data[<span class="st">'Sample'</span>], data[<span class="st">'Court_paragraph'</span>], </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>            margins <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Court_paragraph</th>
<th data-quarto-table-cell-role="th">mer,</th>
<th data-quarto-table-cell-role="th">All</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sample</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">la</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">All</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.ilovesoils\.com\/**");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<script src="https://giscus.app/client.js" data-repo="Kkhurana007/fr_blog_mine" data-repo-id="R_kgDOJuKwyw" data-category="General" data-category-id="DIC_kwDOJuKwy84CXJ4P" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Blog made with <a href="https://quarto.org/">Quarto</a> by Kunal.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Kkhurana007">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/kunalkhurana007">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:Khuranasoilpau@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>